"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[833],{5833:(Ut,U,c)=>{c.r(U),c.d(U,{ProverModule:()=>Ot});var f=c(177),D=c(6554),R=c(8729),e=c(4438);let ie=(()=>{class i{constructor(){}ngOnInit(){}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-followers"]],decls:2,vars:0,template:function(n,r){1&n&&(e.j41(0,"p"),e.EFF(1,"Section in developing..."),e.k0s())}})}return i})();var h=c(9673),re=c(467),x=c(9724),w=c(7468),N=c(3083),M=c(5007),u=c(6354),y=c(8141),p=c(3028),b=function(i){return i[i.Sell=0]="Sell",i[i.Buy=1]="Buy",i}(b||{});let oe=[b.Buy,b.Sell],P={0:"Sell",1:"Buy"};var _=c(8986);class X{usd;btc;constructor(s,t){this.usd=s,this.btc=t}}class se{id;balance;prevBalance;dateFrom;dateTo;percentage;constructor(s,t,n,r,o){this.id=s,this.balance=t,this.prevBalance=n,this.dateFrom=r,this.dateTo=o,0===n&&(n=t),this.percentage=100*(t/n-1)}}class ae{usdBalance;btcBalance;proofs;constructor(s=null,t=null,n=[]){this.usdBalance=s,this.btcBalance=t,this.proofs=n}toZkProofModel(){return{usdBalance:this.usdBalance,btcBalance:this.btcBalance,proofs:this.proofs.map(s=>({id:s.id,currency:s.currency,action:s.action,amount:s.amount,nonce:s.nonce,price:s.price}))}}}class ce{id;currency;action;amount;nonce;price;constructor(s,t,n,r=null,o=null,a=null){this.id=s,this.currency=t,this.action=n,this.amount=r,this.nonce=o,this.price=a}}class Y{id;currency;amount;nonce;action;isProved;price;constructor(s=0,t=null,n=null,r=null,o=null,a=!1){this.id=s,this.currency=t,this.amount=n,this.nonce=r,this.action=o,this.isProved=a}clear(){this.currency=null,this.amount=null,this.nonce=null,this.action=null,this.isProved=!1}}var z=c(8129),le=c(1413),de=c(6129);class K extends le.B{constructor(s=1/0,t=1/0,n=de.U){super(),this._bufferSize=s,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,s),this._windowTime=Math.max(1,t)}next(s){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:a}=this;t||(n.push(s),!r&&n.push(o.now()+a)),this._trimBuffer(),super.next(s)}_subscribe(s){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(s),{_infiniteTimeWindow:n,_buffer:r}=this,o=r.slice();for(let a=0;a<o.length&&!s.closed;a+=n?1:2)s.next(o[a]);return this._checkFinalizedStatuses(s),t}_trimBuffer(){const{_bufferSize:s,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,o=(r?1:2)*s;if(s<1/0&&o<n.length&&n.splice(0,n.length-o),!r){const a=t.now();let l=0;for(let m=1;m<n.length&&n[m]<=a;m+=2)l=m;l&&n.splice(0,l+1)}}}var I=c(3726),G=c(1033),v=c(8810),g=c(7673),ue=c(1985),pe=c(3236),S=c(1594),fe=c(9974),ge=c(4360),he=c(941),ve=c(9437);const Z="indexedDB is not working";class L extends Error{constructor(){super(...arguments),this.message=Z}}class be extends Error{constructor(){super(...arguments),this.message="The storage is currently localStorage,\nwhere data must be serialized, and the provided data can't be serialized."}}const W=new e.nKC("localStoragePrefix",{providedIn:"root",factory:()=>""}),J=new e.nKC("localStorageIDBDBName",{providedIn:"root",factory:()=>"ngStorage"}),H=new e.nKC("localStorageIDBDBVersion",{providedIn:"root",factory:()=>1}),Q=new e.nKC("localStorageIDBStoreName",{providedIn:"root",factory:()=>"localStorage"}),Fe=new e.nKC("localStorageIDBWrap",{providedIn:"root",factory:()=>!0});class q extends Error{constructor(){super(...arguments),this.message="Data stored is not valid against the provided JSON schema.\nCheck your JSON schema, otherwise it means data has been corrupted."}}let $=(()=>{class i{constructor(){this.database=new K(1),this.wrapIndex="value",this.dbName=(0,e.WQX)(J),this.storeName=(0,e.WQX)(Q),this.dbVersion=(0,e.WQX)(H),this.noWrap=(0,e.WQX)(Fe),this.connect()}get backingStore(){return{database:this.dbName,store:this.storeName,version:this.dbVersion}}get size(){return this.transaction("readonly").pipe((0,p.Z)(t=>{const{store:n,events:r}=t,o=n.count();return r.pipe((0,u.T)(()=>o.result))}),(0,S.$)())}get(t){return this.transaction("readonly").pipe((0,p.Z)(n=>{const{store:r,events:o}=n,a=r.get(t);return o.pipe((0,u.T)(()=>{if(null!=a.result)return!this.noWrap&&"object"==typeof a.result&&this.wrapIndex in a.result&&null!=a.result[this.wrapIndex]?a.result[this.wrapIndex]:a.result}))}),(0,S.$)())}set(t,n){return void 0===n?this.delete(t):this.transaction("readwrite").pipe((0,p.Z)(r=>{const{store:o,events:a}=r;return o.put(this.noWrap?n:{[this.wrapIndex]:n},t),a.pipe((0,u.T)(()=>{}))}),(0,S.$)())}delete(t){return this.transaction("readwrite").pipe((0,p.Z)(n=>{const{store:r,events:o}=n;return r.delete(t),o.pipe((0,u.T)(()=>{}))}),(0,S.$)())}clear(){return this.transaction("readwrite").pipe((0,p.Z)(t=>{const{store:n,events:r}=t;return n.clear(),r.pipe((0,u.T)(()=>{}))}),(0,S.$)())}keys(){return this.transaction("readonly").pipe((0,S.$)(),(0,p.Z)(t=>{const{store:n}=t,r=n.openKeyCursor(),o=(0,I.R)(r,"success").pipe(function me(i,s=!1){return(0,fe.N)((t,n)=>{let r=0;t.subscribe((0,ge._)(n,o=>{const a=i(o,r++);(a||s)&&n.next(o),!a&&n.complete()}))})}(()=>null!==r.result),(0,u.T)(()=>r.result.key.toString()),(0,y.M)(()=>{r.result.continue()})),a=this.listenError(r);return(0,G.O)([o,a])}))}has(t){return this.transaction("readonly").pipe((0,p.Z)(n=>{const{store:r,events:o}=n,a=r.getKey(t);return o.pipe((0,u.T)(()=>void 0!==a.result))}),(0,S.$)())}connect(){let t;try{t=indexedDB.open(this.dbName,this.dbVersion)}catch{return void this.database.error(new L)}this.createStore(t);const n=(0,I.R)(t,"success"),r=this.listenError(t);(0,G.O)([n,r]).pipe((0,S.$)()).subscribe({next:()=>{this.database.next(t.result)},error:()=>{this.database.error(new L)}})}createStore(t){(0,I.R)(t,"upgradeneeded").pipe((0,S.$)()).subscribe({next:()=>{t.result.objectStoreNames.contains(this.storeName)||t.result.createObjectStore(this.storeName)}})}transaction(t){return this.database.pipe((0,p.Z)(n=>{let r;try{r=n.transaction([this.storeName],t)}catch(l){return(0,v.$)(()=>l)}const o=r.objectStore(this.storeName),a=this.listenTransactionEvents(r);return(0,g.of)({store:o,events:a})}))}listenError(t){return(0,I.R)(t,"error").pipe((0,p.Z)(n=>(0,v.$)(()=>n.target?.error)))}listenTransactionEvents(t){const n=(0,I.R)(t,"complete"),r=this.listenError(t);return(0,G.O)([n,r])}static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),j=(()=>{class i{constructor(){this.prefix=(0,e.WQX)(W)||""}get size(){return(0,g.of)(localStorage.length)}get(t){const n=localStorage.getItem(this.prefixKey(t));let r;if(null!==n)try{r=JSON.parse(n)}catch(o){return(0,v.$)(()=>o)}return(0,g.of)(r)}set(t,n){let r=null;const o=Object.getPrototypeOf(n);if("object"==typeof n&&null!==n&&!Array.isArray(n)&&o!==Object.prototype&&null!==o)return(0,v.$)(()=>new be);try{r=JSON.stringify(n)}catch(a){return(0,v.$)(()=>a)}try{localStorage.setItem(this.prefixKey(t),r)}catch(a){return(0,v.$)(()=>a)}return(0,g.of)(void 0)}delete(t){return localStorage.removeItem(this.prefixKey(t)),(0,g.of)(void 0)}clear(){return localStorage.clear(),(0,g.of)(void 0)}keys(){return new ue.c(t=>{for(let n=0;n<localStorage.length;n+=1)t.next(this.getUnprefixedKey(n));t.complete()}).pipe((0,he.Q)(pe.E))}has(t){for(let n=0;n<localStorage.length;n+=1)if(t===this.getUnprefixedKey(n))return(0,g.of)(!0);return(0,g.of)(!1)}getUnprefixedKey(t){const n=localStorage.key(t);return null!==n?this.prefix?n.substring(this.prefix.length):n:null}prefixKey(t){return`${this.prefix}${t}`}static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),E=(()=>{class i{constructor(){this.memoryStorage=new Map}get size(){return(0,g.of)(this.memoryStorage.size)}get(t){return(0,g.of)(this.memoryStorage.get(t))}set(t,n){return this.memoryStorage.set(t,n),(0,g.of)(void 0)}delete(t){return this.memoryStorage.delete(t),(0,g.of)(void 0)}clear(){return this.memoryStorage.clear(),(0,g.of)(void 0)}keys(){return(0,x.H)(this.memoryStorage.keys())}has(t){return(0,g.of)(this.memoryStorage.has(t))}static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),ee=(()=>{class i{validate(t,n){switch(n.type){case"string":return this.validateString(t,n);case"number":case"integer":return this.validateNumber(t,n);case"boolean":return this.validateBoolean(t,n);case"array":return this.validateArray(t,n);case"object":return this.validateObject(t,n)}}validateString(t,n){if("string"!=typeof t||!this.validateConst(t,n)||!this.validateEnum(t,n)||void 0!==n.maxLength&&t.length>n.maxLength||void 0!==n.minLength&&t.length<n.minLength)return!1;if(n.pattern){let r=null;try{r=new RegExp(n.pattern)}catch{}if(r&&!r.test(t))return!1}return!0}validateNumber(t,n){return!("number"!=typeof t||"integer"===n.type&&!Number.isInteger(t)||!this.validateConst(t,n)||!this.validateEnum(t,n)||n.multipleOf&&!Number.isInteger(t/n.multipleOf)||void 0!==n.maximum&&t>n.maximum||void 0!==n.exclusiveMaximum&&t>=n.exclusiveMaximum||void 0!==n.minimum&&t<n.minimum||void 0!==n.exclusiveMinimum&&t<=n.exclusiveMinimum)}validateBoolean(t,n){return!("boolean"!=typeof t||!this.validateConst(t,n))}validateArray(t,n){if(!Array.isArray(t)||void 0!==n.maxItems&&t.length>n.maxItems||void 0!==n.minItems&&t.length<n.minItems)return!1;if(n.uniqueItems){const r=new Set(t);if(t.length!==r.size)return!1}if(Array.isArray(n.items)||void 0===n.items)return this.validateTuple(t,n.items);for(const r of t)if(!this.validate(r,n.items))return!1;return!0}validateTuple(t,n){if(t.length!==(n?n.length:0))return!1;if(n)for(let o=0;o<n.length;o+=1)if(!this.validate(t[o],n[o]))return!1;return!0}validateObject(t,n){if("object"!=typeof t||null===t||Object.keys(n.properties).length<Object.keys(t).length)return!1;if(n.required)for(const r of n.required)if(!Object.prototype.hasOwnProperty.call(t,r))return!1;for(const r in n.properties)if(Object.prototype.hasOwnProperty.call(n.properties,r)&&Object.prototype.hasOwnProperty.call(t,r)&&!this.validate(t[r],n.properties[r]))return!1;return!0}validateConst(t,n){return!n.const||t===n.const}validateEnum(t,n){return!n.enum||n.enum.includes(t)}static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Be=(()=>{class i{static#e=this.\u0275fac=function(n){return new(n||i)};static#t=this.\u0275prov=e.jDH({token:i,factory:()=>function Ce(){const i=(0,e.WQX)(e.Agw);try{if((0,f.UE)(i)&&void 0!==indexedDB&&null!==indexedDB&&"open"in indexedDB)return new $;if((0,f.UE)(i)&&void 0!==localStorage&&null!==localStorage&&"getItem"in localStorage)return new j}catch{}return new E}(),providedIn:"root"})}return i})(),xe=(()=>{class i{constructor(t,n=new ee){this.database=t,this.jsonValidator=n,this.notifiers=new Map}get size(){return this.database.size.pipe(this.catchIDBBroken(()=>this.database.size))}get backingEngine(){return this.database instanceof $?"indexedDB":this.database instanceof j?"localStorage":this.database instanceof E?"memory":"unknown"}get backingStore(){return this.database instanceof $?this.database.backingStore:{database:"",store:"",version:0}}get fallbackBackingStore(){return this.database instanceof j?{prefix:this.database.prefix}:{prefix:""}}get(t,n){return this.database.get(t).pipe(this.catchIDBBroken(()=>this.database.get(t)),(0,p.Z)(r=>null==r?(0,g.of)(void 0):n?this.jsonValidator.validate(r,n)?(0,g.of)(r):(0,v.$)(()=>new q):(0,g.of)(r)))}set(t,n,r){return null==n?this.delete(t):r&&!this.jsonValidator.validate(n,r)?(0,v.$)(()=>new q):this.database.set(t,n).pipe(this.catchIDBBroken(()=>this.database.set(t,n)),(0,y.M)(()=>{this.notify(t,n)}))}delete(t){return this.database.delete(t).pipe(this.catchIDBBroken(()=>this.database.delete(t)),(0,y.M)(()=>{this.notify(t,void 0)}))}clear(){return this.database.clear().pipe(this.catchIDBBroken(()=>this.database.clear()),(0,y.M)(()=>{for(const t of this.notifiers.keys())this.notify(t,void 0)}))}keys(){return this.database.keys().pipe(this.catchIDBBroken(()=>this.database.keys()))}has(t){return this.database.has(t).pipe(this.catchIDBBroken(()=>this.database.has(t)))}watch(t,n){this.notifiers.has(t)||this.notifiers.set(t,new K(1));const r=this.notifiers.get(t);return(n?this.get(t,n):this.get(t)).subscribe({next:o=>{r.next(o)},error:o=>{r.error(o)}}),r.asObservable()}notify(t,n){const r=this.notifiers.get(t);r&&r.next(n)}catchIDBBroken(t){return(0,ve.W)(n=>{if(null!=n&&"object"==typeof n&&"message"in n&&n.message===Z){try{this.database="getItem"in localStorage?new j:new E}catch{this.database=new E}return t()}return(0,v.$)(()=>n)})}static#e=this.\u0275fac=function(n){return new(n||i)(e.KVO(Be),e.KVO(ee))};static#t=this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),we=(()=>{class i{storage;constructor(t){this.storage=t}set(t,n){return this.storage.set(t,n)}delete(t){return this.storage.delete(t)}get(t){return this.storage.get(t).pipe((0,u.T)(n=>n))}static \u0275fac=function(n){return new(n||i)(e.KVO(xe))};static \u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var te=c(3465),je=c(6546);let C=(()=>{class i{contract;priceService;storageService;walletService;zkService;signalsKey="signals";balancesKey="balances";constructor(t,n,r,o,a){this.contract=t,this.priceService=n,this.storageService=r,this.walletService=o,this.zkService=a}addTrader(t){return(0,x.H)(this.contract.newTrader(t))}getStorageBalances(){return this.storageService.get(this.balancesKey).pipe((0,u.T)(t=>t||{}))}getMyStorageBalance(){return this.getStorageBalances().pipe((0,u.T)(t=>t[this.walletService.getAddress()]||[new X(_.A.decimalDigitsNumber(h.A.initialUsdBalance),_.A.decimalDigitsNumber(h.A.initialBtcBalance))]))}getProofList(){return(0,x.H)(this.getProof())}getProof(){var t=this;return(0,re.A)(function*(){const n=yield t.contract.getTrader(null);let r=[];for(let m=0;m<n.proofsCount;m++)r.push(yield t.contract.getPeriodProofs(n.address,m));let o=[],a=_.A.decimalDigitsNumber(h.A.initialUsdBalance),l=yield t.contract.getTimestampByBlockNumber(n.creationBlockNumber);for(let m=0;m<r.length;m++){const F=r[m],B=yield t.contract.getTimestampByBlockNumber(F.blockNumber);o.push(new se(m,F.y,a,new Date(l),new Date(B))),a=F.y,l=B}return o})()}addSignal(t,n){return this.getSignalsMap().pipe((0,y.M)(r=>{if((r[this.walletService.getAddress()]||[]).filter(l=>!l.isProved).length>=h.A.tradeSize)throw new Error("You need generate proof for current signals")}),(0,p.Z)(()=>this.contract.addSignal(n,BigInt(this.priceService.getBtcPriceValue()))),(0,p.Z)(()=>(0,w.p)({map:this.getSignalsMap(),newSignal:this.getSignalsMap().pipe((0,u.T)(r=>(r[this.walletService.getAddress()]||[]).length),(0,p.Z)(r=>this.contract.getSignal(this.walletService.getAddress(),r)))}).pipe((0,u.T)(r=>{let o=r.map,a=o[this.walletService.getAddress()]||[],l=new Y(a.length,t.currency,t.amount,t.nonce,t.action);return l.price=r.newSignal.price,a.push(l),o[this.walletService.getAddress()]=a,{storage:o,newSignal:l}}))),(0,p.Z)(r=>this.storageService.set(this.signalsKey,r.storage).pipe((0,u.T)(()=>r.newSignal))),(0,p.Z)(r=>(0,w.p)({balances:this.getStorageBalances(),myBalances:this.getMyStorageBalance(),newSignal:(0,N.c)([r],M.$)}).pipe((0,p.Z)(o=>{let a=o.myBalances.slice(-1)[0].usd,l=o.myBalances.slice(-1)[0].btc;const m=_.A.removeDecimalDigitsNumber(o.newSignal.amount*o.newSignal.price),F=o.newSignal.amount;o.newSignal.action===b.Buy?(a-=m,l+=F):o.newSignal.action===b.Sell&&(a+=m,l-=F);let B=new X(a,l);return o.myBalances.push(B),o.balances[this.walletService.getAddress()]=o.myBalances,this.storageService.set(this.balancesKey,o.balances).pipe((0,u.T)(()=>o.newSignal),(0,p.Z)(()=>(0,w.p)({newBalance:(0,N.c)([B],M.$),newSignal:(0,N.c)([r],M.$)})))}))))}getMySignals(){return this.getSignalsMap().pipe((0,u.T)(t=>t||{}),(0,u.T)(t=>t[this.walletService.getAddress()]||[]),(0,u.T)(t=>t))}getNextSignalsForProof(){return this.getMySignals().pipe((0,u.T)(t=>t.filter(n=>!n.isProved).slice(0,h.A.tradeSize)))}getSignalsMap(){return this.storageService.get(this.signalsKey).pipe((0,u.T)(t=>t||{}))}addPeriodProof(){return(0,w.p)({signals:this.getNextSignalsForProof(),balances:this.getMyStorageBalance()}).pipe((0,u.T)(t=>{if(t.signals.length<h.A.tradeSize)throw new Error("No signals");let n=Math.floor(t.signals[0].id/h.A.tradeSize)*h.A.tradeSize;return new ae(t.balances[n].usd,t.balances[n].btc,t.signals.map((r,o)=>new ce(o,r.currency,r.action,r.amount,r.nonce,r.price))).toZkProofModel()}),(0,p.Z)(t=>this.zkService.prove(t)),(0,p.Z)(()=>this.getSignalsMap()),(0,u.T)(t=>(t[this.walletService.getAddress()].filter(n=>!n.isProved).slice(0,h.A.tradeSize).every(n=>n.isProved=!0),t)),(0,p.Z)(t=>this.storageService.set(this.signalsKey,t)))}static \u0275fac=function(n){return new(n||i)(e.KVO("SmartContractInterface"),e.KVO(z.d),e.KVO(we),e.KVO(te.F),e.KVO(je.v))};static \u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var T=c(7511);function Ee(i,s){if(1&i&&(e.j41(0,"div",8)(1,"div",12)(2,"span"),e.EFF(3,"Unproved signals:"),e.k0s()(),e.j41(4,"div",13)(5,"span"),e.EFF(6),e.k0s()()()),2&i){const t=e.XpG();e.R7$(6),e.JRh(t.unprovedSignalsCount)}}let Ae=(()=>{class i{toastr;traderService;proofAdded=new e.bkB;tradeSize=h.A.tradeSize;unprovedSignalsCount;isGenerating=!1;canGenerate=!1;constructor(t,n){this.toastr=t,this.traderService=n}ngOnInit(){this.initUnprovedSignals()}initUnprovedSignals(){this.traderService.getMySignals().subscribe(t=>{this.unprovedSignalsCount=t.filter(n=>!n.isProved).length,this.canGenerate=this.unprovedSignalsCount===h.A.tradeSize},t=>{this.toastr.error("Can not get unproved signals count"),console.log(t)})}generateProof(){this.flipGenerating(),this.traderService.addPeriodProof().subscribe(()=>{this.proofAdded.emit(),this.initUnprovedSignals(),this.flipGenerating()},t=>{this.toastr.error("Can not add wrong proof"),console.log(t),this.flipGenerating()})}flipGenerating(){this.isGenerating=!this.isGenerating}static \u0275fac=function(n){return new(n||i)(e.rXU(T.f),e.rXU(C))};static \u0275cmp=e.VBU({type:i,selectors:[["app-generate-proof"]],outputs:{proofAdded:"proofAdded"},decls:20,vars:4,consts:[[1,"row"],[1,"col"],["role","alert",1,"alert","alert-info"],[1,"alert-heading","my-3"],[1,"mb-0"],["role","alert",1,"alert","alert-warning"],["class","row m-2",4,"ngIf"],[1,"alert","alert-dark","shadow-lg","rounded-lg"],[1,"row","m-2"],[1,"col","text-center"],["type","submit",1,"btn","btn-lg","btn-success",3,"click","disabled"],[1,"p-3"],[1,"col-10","text-center"],[1,"col-2","text-center"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e.EFF(4,"Generate proof form"),e.k0s(),e.nrm(5,"hr"),e.j41(6,"p",4),e.EFF(7),e.k0s()()()(),e.j41(8,"div",0)(9,"div",1)(10,"div",5),e.DNE(11,Ee,7,1,"div",6),e.k0s()()(),e.j41(12,"div",0)(13,"div",1)(14,"div",7)(15,"div",8)(16,"div",9)(17,"button",10),e.bIt("click",function(){return r.generateProof()}),e.j41(18,"span",11),e.EFF(19),e.k0s()()()()()()()),2&n&&(e.R7$(7),e.SpI("Every ",r.tradeSize," last signals are used for one proof "),e.R7$(4),e.Y8G("ngIf",void 0!==r.unprovedSignalsCount),e.R7$(6),e.Y8G("disabled",!r.canGenerate||r.isGenerating),e.R7$(2),e.JRh(r.isGenerating?"Generating...":"Generate Proof"))},dependencies:[f.bT],styles:[".input-field[_ngcontent-%COMP%]{min-width:92px}"]})}return i})();const De=(i,s)=>({"table-success":i,"table-danger":s});function Re(i,s){1&i&&e.eu8(0)}function Ne(i,s){1&i&&(e.j41(0,"h4"),e.EFF(1,"Loading..."),e.k0s())}function Me(i,s){1&i&&e.eu8(0)}function Pe(i,s){if(1&i&&e.DNE(0,Me,1,0,"ng-container",6),2&i){const t=e.XpG(),n=e.sdS(10),r=e.sdS(12);e.Y8G("ngIf",t.proof&&t.proof.length>0)("ngIfThen",n)("ngIfElse",r)}}function Ge(i,s){if(1&i&&(e.j41(0,"tr")(1,"td",10),e.EFF(2),e.k0s(),e.j41(3,"td",10),e.EFF(4),e.k0s(),e.j41(5,"td",10),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.j41(8,"td",10),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td",12),e.EFF(12),e.nI1(13,"number"),e.k0s()()),2&i){const t=s.$implicit,n=s.index,r=e.XpG(2);e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(r.tradeSize),e.R7$(2),e.JRh(e.i5U(7,6,t.dateFrom,"d MMMM y hh:mm aa")),e.R7$(3),e.JRh(e.i5U(10,9,t.dateTo,"d MMMM y hh:mm aa")),e.R7$(2),e.Y8G("ngClass",e.l_i(15,De,t.percentage>0,t.percentage<0)),e.R7$(),e.SpI("",e.i5U(13,12,t.percentage,"1.2-2"),"%")}}function $e(i,s){if(1&i&&(e.j41(0,"table",9)(1,"tbody")(2,"tr")(3,"td",10),e.EFF(4,"\u2116"),e.k0s(),e.j41(5,"td",10),e.EFF(6,"Signals count"),e.k0s(),e.j41(7,"td",10),e.EFF(8,"From"),e.k0s(),e.j41(9,"td",10),e.EFF(10,"To"),e.k0s(),e.j41(11,"td",10),e.EFF(12,"Profit"),e.k0s()(),e.DNE(13,Ge,14,18,"tr",11),e.k0s()()),2&i){const t=e.XpG();e.R7$(13),e.Y8G("ngForOf",t.proof)}}function Ve(i,s){1&i&&(e.j41(0,"h4"),e.EFF(1,"There are no proof yet"),e.k0s())}let Oe=(()=>{class i{traderService;proof;isLoading=!0;tradeSize=h.A.tradeSize;constructor(t){this.traderService=t}ngOnInit(){this.initProof(!0)}initProof(t=!1){this.traderService.getProofList().subscribe(n=>{this.proof=n,t&&this.flipLoading()})}flipLoading(){this.isLoading=!this.isLoading}onProofAdded(){this.initProof()}static \u0275fac=function(n){return new(n||i)(e.rXU(C))};static \u0275cmp=e.VBU({type:i,selectors:[["app-proof"]],decls:13,vars:3,consts:[["loadingTmpl",""],["loadedTmpl",""],["proofTmpl",""],["noProofTmpl",""],[1,"row","m-3"],[1,"col-xl-8","text-center"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"col-xl-4","text-center"],[3,"proofAdded"],[1,"table","table-bordered","m-1","w-100"],[1,"align-middle","text-center"],[4,"ngFor","ngForOf"],[1,"align-middle","text-center",3,"ngClass"]],template:function(n,r){if(1&n){const o=e.RV6();e.j41(0,"div",4)(1,"div",5),e.DNE(2,Re,1,0,"ng-container",6),e.k0s(),e.j41(3,"div",7)(4,"app-generate-proof",8),e.bIt("proofAdded",function(){return e.eBV(o),e.Njj(r.onProofAdded())}),e.k0s()()(),e.DNE(5,Ne,2,0,"ng-template",null,0,e.C5r)(7,Pe,1,3,"ng-template",null,1,e.C5r)(9,$e,14,1,"ng-template",null,2,e.C5r)(11,Ve,2,0,"ng-template",null,3,e.C5r)}if(2&n){const o=e.sdS(6),a=e.sdS(8);e.R7$(2),e.Y8G("ngIf",r.isLoading)("ngIfThen",o)("ngIfElse",a)}},dependencies:[f.YU,f.Sq,f.bT,Ae,f.QX,f.vh]})}return i})();var ne=c(614),A=function(i){return i.BTC="btc",i.SIB="sib",i.ETH="eth",i}(A||{});let Ue=[A.BTC,A.SIB,A.ETH],V={btc:"BTC",sib:"SIB",eth:"ETH"};var O=c(60),k=function(i){return i[i.Undefined=0]="Undefined",i[i.Adding=1]="Adding",i[i.Successed=2]="Successed",i[i.Failed=3]="Failed",i}(k||{});let Xe=(()=>{class i{constructor(){}hash(t){return window.signalHash(t.action.valueOf(),t.amount,t.nonce)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Ye(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",1)(1,"button",5),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.selectCurrency(r))}),e.EFF(2),e.k0s()()}if(2&i){const t=s.$implicit,n=e.XpG();e.R7$(),e.Y8G("disabled","btc"!==t),e.R7$(),e.SpI(" ",n.currenciesText[t]," ")}}let ze=(()=>{class i{signal;ready=new e.bkB;back=new e.bkB;currencies=Ue;currenciesText=V;constructor(){}ngOnInit(){}selectCurrency(t){this.signal.currency=t,this.ready.emit()}backClick(){this.back.emit()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-currency"]],inputs:{signal:"signal"},outputs:{ready:"ready",back:"back"},decls:10,vars:1,consts:[[1,"row","my-1"],[1,"col"],[1,"btn","btn-link",3,"click"],[1,"row","align-items-center","my-1"],["class","col",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-lg","btn-outline-dark",3,"click","disabled"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.bIt("click",function(){return r.backClick()}),e.EFF(3,"Back"),e.k0s(),e.j41(4,"h3"),e.EFF(5,"Select currency:"),e.k0s()()(),e.j41(6,"div",3),e.nrm(7,"div",1),e.DNE(8,Ye,3,2,"div",4),e.nrm(9,"div",1),e.k0s()),2&n&&(e.R7$(8),e.Y8G("ngForOf",r.currencies))},dependencies:[f.Sq]})}return i})();var d=c(9417),Ke=c(9830);let Ze=(()=>{class i{priceService;toastr;signal;balance;ready=new e.bkB;back=new e.bkB;amount;constructor(t,n){this.priceService=t,this.toastr=n}ngOnInit(){}enterAmount(){const t=_.A.decimalDigitsNumber(+this.amount.replace(" ","").replace(",","."));this.isBalanceEnoughAtMoment(t)?(this.signal.amount=t,this.ready.emit()):this.toastr.error("Not enough balance for this action")}backClick(){this.back.emit()}isBalanceEnoughAtMoment(t){if(this.signal.action===b.Buy)return t*_.A.removeDecimalDigitsNumber(this.priceService.getBtcPriceValue())<=this.balance.usd;if(this.signal.action===b.Sell)return t<=this.balance.btc;throw new Error('Unknown action - select "Buy" or "Sell"')}static \u0275fac=function(n){return new(n||i)(e.rXU(z.d),e.rXU(T.f))};static \u0275cmp=e.VBU({type:i,selectors:[["app-amount"]],inputs:{signal:"signal",balance:"balance"},outputs:{ready:"ready",back:"back"},decls:13,vars:5,consts:[[1,"row","my-1"],[1,"col"],[1,"btn","btn-link",3,"click"],[1,"row","align-items-center","my-1"],[3,"ngSubmit"],[1,"input-group","input-group-lg"],["required","","type","text","id","sum","name","sum",1,"form-control","text-center",3,"ngModelChange","dropSpecialCharacters","allowNegativeNumbers","mask","ngModel"],["type","submit",1,"btn","btn-dark",3,"disabled"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.bIt("click",function(){return r.backClick()}),e.EFF(3,"Back"),e.k0s(),e.j41(4,"h3"),e.EFF(5,"Enter amount:"),e.k0s()()(),e.j41(6,"div",3)(7,"div",1)(8,"form",4),e.bIt("ngSubmit",function(){return r.enterAmount()}),e.j41(9,"div",5)(10,"input",6),e.mxI("ngModelChange",function(a){return e.DH7(r.amount,a)||(r.amount=a),a}),e.k0s(),e.j41(11,"button",7),e.EFF(12,"Next..."),e.k0s()()()()()),2&n&&(e.R7$(10),e.Y8G("dropSpecialCharacters",!1)("allowNegativeNumbers",!1)("mask","separator.4"),e.R50("ngModel",r.amount),e.R7$(),e.Y8G("disabled",!r.amount||+r.amount<=0))},dependencies:[d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV,Ke.Zr]})}return i})(),Le=(()=>{class i{signal;ready=new e.bkB;back=new e.bkB;constructor(){}ngOnInit(){}enterNonce(){this.ready.emit()}backClick(){this.back.emit()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-nonce"]],inputs:{signal:"signal"},outputs:{ready:"ready",back:"back"},decls:13,vars:2,consts:[[1,"row","my-1"],[1,"col"],[1,"btn","btn-link",3,"click"],[1,"row","align-items-center","my-1"],[3,"ngSubmit"],[1,"input-group","input-group-lg"],["required","","type","number","id","nonce","name","nonce","min","-128","max","127",1,"form-control","text-center",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-dark",3,"disabled"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.bIt("click",function(){return r.backClick()}),e.EFF(3,"Back"),e.k0s(),e.j41(4,"h3"),e.EFF(5,"Enter nonce [-127...127]:"),e.k0s()()(),e.j41(6,"div",3)(7,"div",1)(8,"form",4),e.bIt("ngSubmit",function(){return r.enterNonce()}),e.j41(9,"div",5)(10,"input",6),e.mxI("ngModelChange",function(a){return e.DH7(r.signal.nonce,a)||(r.signal.nonce=a),a}),e.k0s(),e.j41(11,"button",7),e.EFF(12,"Add"),e.k0s()()()()()),2&n&&(e.R7$(10),e.R50("ngModel",r.signal.nonce),e.R7$(),e.Y8G("disabled",!r.signal.nonce&&0!=r.signal.nonce||r.signal.nonce<-128||r.signal.nonce>127))},dependencies:[d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.VZ,d.zX,d.vS,d.cV]})}return i})();function We(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",1)(1,"button",5),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.setAction(r))}),e.j41(2,"span",6),e.EFF(3),e.k0s()()()}if(2&i){const t=s.$implicit,n=e.XpG();e.R7$(3),e.JRh(n.actionsText[t])}}let Je=(()=>{class i{signal;ready=new e.bkB;back=new e.bkB;actions=oe;actionsText=P;constructor(){}ngOnInit(){}setAction(t){this.signal.action=t,this.ready.emit()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-action"]],inputs:{signal:"signal"},outputs:{ready:"ready",back:"back"},decls:10,vars:2,consts:[[1,"row","my-1"],[1,"col"],[1,"btn","btn-link",3,"disabled"],[1,"row","align-items-center","my-1"],["class","col",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-lg","btn-outline-dark",3,"click"],[1,"p-3"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"button",2),e.EFF(3,"Back"),e.k0s(),e.j41(4,"h3"),e.EFF(5,"Select action:"),e.k0s()()(),e.j41(6,"div",3),e.nrm(7,"div",1),e.DNE(8,We,4,1,"div",4),e.nrm(9,"div",1),e.k0s()),2&n&&(e.R7$(2),e.Y8G("disabled",!0),e.R7$(6),e.Y8G("ngForOf",r.actions))},dependencies:[f.Sq]})}return i})();function He(i,s){1&i&&e.eu8(0)}function Qe(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",8)(1,"div",5)(2,"button",9),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.retry())}),e.EFF(3,"One more?"),e.k0s()()()}}function qe(i,s){1&i&&(e.j41(0,"h4",10),e.EFF(1,"Signal is adding..."),e.k0s())}function et(i,s){1&i&&e.eu8(0)}function tt(i,s){if(1&i&&e.DNE(0,et,1,0,"ng-container",6),2&i){const t=e.XpG(),n=e.sdS(9),r=e.sdS(11);e.Y8G("ngIf",2===t.signalState)("ngIfThen",n)("ngIfElse",r)}}function nt(i,s){1&i&&(e.j41(0,"h4",11),e.EFF(1,"Signal is successfully added!"),e.k0s())}function it(i,s){1&i&&(e.j41(0,"h4",12),e.EFF(1,"Signal adding is failed"),e.k0s())}let rt=(()=>{class i{signalState;ready=new e.bkB;constructor(){}ngOnInit(){}retry(){this.ready.emit()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-final"]],inputs:{signalState:"signalState"},outputs:{ready:"ready"},decls:12,vars:4,consts:[["addingTmpl",""],["addedTmpl",""],["successedTmpl",""],["failedTmpl",""],[1,"row","my-1"],[1,"col"],[4,"ngIf","ngIfThen","ngIfElse"],["class","row align-items-center my-1",4,"ngIf"],[1,"row","align-items-center","my-1"],[1,"btn","btn-outline-dark",3,"click"],[1,"text-info"],[1,"text-success"],[1,"text-danger"]],template:function(n,r){if(1&n&&(e.j41(0,"div",4)(1,"div",5),e.DNE(2,He,1,0,"ng-container",6),e.k0s()(),e.DNE(3,Qe,4,0,"div",7)(4,qe,2,0,"ng-template",null,0,e.C5r)(6,tt,1,3,"ng-template",null,1,e.C5r)(8,nt,2,0,"ng-template",null,2,e.C5r)(10,it,2,0,"ng-template",null,3,e.C5r)),2&n){const o=e.sdS(5),a=e.sdS(7);e.R7$(2),e.Y8G("ngIf",1===r.signalState)("ngIfThen",o)("ngIfElse",a),e.R7$(),e.Y8G("ngIf",1!==r.signalState)}},dependencies:[f.bT]})}return i})();function ot(i,s){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",9)(3,"div",0)(4,"div",10),e.EFF(5,"USD:"),e.k0s(),e.j41(6,"div",11),e.EFF(7),e.nI1(8,"number"),e.k0s()()()(),e.j41(9,"div",1)(10,"div",9)(11,"div",0)(12,"div",10),e.EFF(13,"BTC:"),e.k0s(),e.j41(14,"div",11),e.EFF(15),e.nI1(16,"number"),e.k0s()()()()()),2&i){const t=e.XpG();e.R7$(7),e.SpI("",e.i5U(8,2,t.balance.usd/t.maxDecimals,"1.2-2"),"$"),e.R7$(8),e.JRh(e.i5U(16,5,t.balance.btc/t.maxDecimals,"1.4-4"))}}function st(i,s){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"app-action",12),e.bIt("ready",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onReady())}),e.k0s(),e.bVm()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("signal",t.signal)}}function at(i,s){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"app-currency",13),e.bIt("ready",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onReady())})("back",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onBack())}),e.k0s(),e.bVm()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("signal",t.signal)}}function ct(i,s){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"app-amount",14),e.bIt("ready",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onReady())})("back",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onBack())}),e.k0s(),e.bVm()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("signal",t.signal)("balance",t.balance)}}function lt(i,s){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"app-nonce",13),e.bIt("ready",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onReady())})("back",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onBack())}),e.k0s(),e.bVm()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("signal",t.signal)}}function dt(i,s){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"app-final",15),e.bIt("ready",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.onReady())}),e.k0s(),e.bVm()}if(2&i){const t=e.XpG();e.R7$(),e.Y8G("signalState",t.signalState)}}function ut(i,s){if(1&i&&(e.j41(0,"p",4)(1,"span",16),e.EFF(2),e.k0s(),e.j41(3,"span",16),e.EFF(4),e.nI1(5,"number"),e.k0s(),e.j41(6,"span",16),e.EFF(7),e.k0s()()),2&i){const t=e.XpG();e.R7$(2),e.JRh(t.actionsText[t.signal.action]||"?"),e.R7$(2),e.JRh(t.signal.amount?e.i5U(5,3,t.signal.amount/t.maxDecimals,"1.4-4"):"?"),e.R7$(3),e.JRh(t.currenciesText[t.signal.currency]||"?")}}let pt=(()=>{class i{toastr;traderService;signalService;signalAdded=new e.bkB;stepCount=5;actionsText=P;currenciesText=V;maxDecimals=10**h.A.maxDecimalDigits;signal=new Y;balance;signalState=k.Undefined;addingStep=0;constructor(t,n,r){this.toastr=t,this.traderService=n,this.signalService=r}ngOnInit(){this.initBalance()}initBalance(){this.traderService.getMyStorageBalance().subscribe(t=>{this.balance=t.slice(-1)[0]},t=>{this.toastr.error("Something went wrong"),console.log(t)})}onReady(){this.addingStep%this.stepCount==this.stepCount-2&&(this.signalState=k.Adding,this.sendSignal()),this.addingStep=(this.addingStep+1)%this.stepCount}onBack(){this.addingStep>0&&this.addingStep<this.stepCount-1&&(this.addingStep=(this.addingStep-1)%this.stepCount)}sendSignal(){if(!this.signal.currency||!this.signal.amount||!this.signal.nonce)return this.toastr.error("Signal's data is empty"),this.signalState=k.Failed,void this.signal.clear();const t=this.signalService.hash(this.signal);this.traderService.addSignal(this.signal,t).subscribe(n=>{this.signalState=k.Successed,this.balance=n.newBalance,this.signalAdded.emit(n.newSignal),this.signal.clear()},n=>{this.toastr.error("Max unproved signals - "+h.A.tradeSize,"Signal adding failed"),console.log(n),this.signalState=k.Failed,this.signal.clear()})}static \u0275fac=function(n){return new(n||i)(e.rXU(T.f),e.rXU(C),e.rXU(Xe))};static \u0275cmp=e.VBU({type:i,selectors:[["app-add-signal"]],outputs:{signalAdded:"signalAdded"},decls:19,vars:7,consts:[[1,"row"],[1,"col"],["role","alert",1,"alert","alert-info"],[1,"alert-heading","my-3"],[1,"mb-0"],["class","row",4,"ngIf"],[1,"alert","alert-dark","shadow-lg","rounded-lg"],[4,"ngIf"],["class","mb-0",4,"ngIf"],["role","alert",1,"alert","alert-warning"],[1,"col-md-4"],[1,"col-md-8"],[3,"ready","signal"],[3,"ready","back","signal"],[3,"ready","back","signal","balance"],[3,"ready","signalState"],[1,"mx-2"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e.EFF(4,"New signal form"),e.k0s(),e.nrm(5,"hr"),e.j41(6,"p",4),e.EFF(7,"Don't reload page until transaction is confirmed"),e.k0s()()()(),e.DNE(8,ot,17,8,"div",5),e.j41(9,"div",0)(10,"div",1)(11,"div",6),e.DNE(12,st,2,1,"ng-container",7)(13,at,2,1,"ng-container",7)(14,ct,2,2,"ng-container",7)(15,lt,2,1,"ng-container",7)(16,dt,2,1,"ng-container",7),e.nrm(17,"hr"),e.DNE(18,ut,8,6,"p",8),e.k0s()()()),2&n&&(e.R7$(8),e.Y8G("ngIf",r.balance),e.R7$(4),e.Y8G("ngIf",0===r.addingStep),e.R7$(),e.Y8G("ngIf",1===r.addingStep),e.R7$(),e.Y8G("ngIf",2===r.addingStep),e.R7$(),e.Y8G("ngIf",3===r.addingStep),e.R7$(),e.Y8G("ngIf",4===r.addingStep),e.R7$(2),e.Y8G("ngIf",4!==r.addingStep))},dependencies:[f.bT,ze,Ze,Le,Je,rt,f.QX],styles:[".input-field[_ngcontent-%COMP%]{min-width:92px}.moony-gradient[_ngcontent-%COMP%]:not(:hover){background:linear-gradient(#ddd,#fff)}"]})}return i})();function ft(i,s){if(1&i&&e.nrm(0,"fa-icon",9),2&i){const t=e.XpG(2);e.Y8G("icon",t.faCheckCircle)}}function gt(i,s){if(1&i&&e.nrm(0,"fa-icon",10),2&i){const t=e.XpG(2);e.Y8G("icon",t.faTimesCircle)}}function mt(i,s){if(1&i&&(e.j41(0,"tr")(1,"td",5),e.EFF(2),e.k0s(),e.j41(3,"td",5),e.EFF(4),e.k0s(),e.j41(5,"td",5),e.EFF(6),e.nI1(7,"number"),e.k0s(),e.j41(8,"td",5),e.EFF(9),e.k0s(),e.j41(10,"td",5),e.EFF(11),e.k0s(),e.j41(12,"td",5),e.EFF(13),e.nI1(14,"number"),e.k0s(),e.j41(15,"td",5),e.DNE(16,ft,1,1,"fa-icon",7)(17,gt,1,1,"fa-icon",8),e.k0s()()),2&i){const t=s.$implicit,n=s.index,r=e.XpG();e.R7$(2),e.JRh(n+1),e.R7$(2),e.JRh(r.actionsText[t.action]),e.R7$(2),e.JRh(e.i5U(7,8,t.amount/r.maxDecimals,"1.4-4")),e.R7$(3),e.JRh(t.nonce),e.R7$(2),e.JRh(r.currenciesText[t.currency]),e.R7$(2),e.SpI("",e.i5U(14,11,t.price/r.maxDecimals,"1.0-0"),"$"),e.R7$(3),e.Y8G("ngIf",t.isProved),e.R7$(),e.Y8G("ngIf",!t.isProved)}}let ht=(()=>{class i{toastr;traderService;actionsText=P;currenciesText=V;faCheckCircle=ne.SGM;faTimesCircle=ne.s0Q;maxDecimals=10**h.A.maxDecimalDigits;signals;constructor(t,n){this.toastr=t,this.traderService=n}ngOnInit(){this.initSignals()}initSignals(){this.traderService.getMySignals().subscribe(t=>{this.signals=t},t=>{this.toastr.error("Something went wrong"),console.log(t)})}onSignalAdded(t){this.signals||(this.signals=[]),this.signals.push(t)}static \u0275fac=function(n){return new(n||i)(e.rXU(T.f),e.rXU(C))};static \u0275cmp=e.VBU({type:i,selectors:[["app-signals"]],decls:22,vars:1,consts:[[1,"row","m-3"],[1,"col-xl-4","text-center"],[3,"signalAdded"],[1,"col-xl-8","text-center"],[1,"table","table-bordered","m-1","w-100"],[1,"align-middle","text-center"],[4,"ngFor","ngForOf"],["style","color: darkgreen","size","2x",3,"icon",4,"ngIf"],["style","color: darkred","size","2x",3,"icon",4,"ngIf"],["size","2x",2,"color","darkgreen",3,"icon"],["size","2x",2,"color","darkred",3,"icon"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"app-add-signal",2),e.bIt("signalAdded",function(a){return r.onSignalAdded(a)}),e.k0s()(),e.j41(3,"div",3)(4,"table",4)(5,"tbody")(6,"tr")(7,"td",5),e.EFF(8,"\u2116"),e.k0s(),e.j41(9,"td",5),e.EFF(10,"Action"),e.k0s(),e.j41(11,"td",5),e.EFF(12,"Amount"),e.k0s(),e.j41(13,"td",5),e.EFF(14,"Nonce"),e.k0s(),e.j41(15,"td",5),e.EFF(16,"Currency"),e.k0s(),e.j41(17,"td",5),e.EFF(18,"Price"),e.k0s(),e.j41(19,"td",5),e.EFF(20,"Proved"),e.k0s()(),e.DNE(21,mt,18,14,"tr",6),e.k0s()()()()),2&n&&(e.R7$(21),e.Y8G("ngForOf",r.signals))},dependencies:[f.Sq,f.bT,O.aY,pt,f.QX]})}return i})();var vt=c(5964),St=c(4375);class bt{email;constructor(s=null){this.email=s}}function yt(i,s){1&i&&(e.j41(0,"div",17)(1,"div",18)(2,"span"),e.EFF(3,"Please, wait. You will be redirected automatically..."),e.k0s()()())}let _t=(()=>{class i{toastr;traderService;traderAdded=new e.bkB;account=new bt;isAdding=!1;constructor(t,n){this.toastr=t,this.traderService=n}ngOnInit(){}addEmail(){this.account.email?(this.isAdding=!0,this.traderService.addTrader(this.account.email).subscribe(()=>{this.traderAdded.emit(this.account.email),this.isAdding=!1},t=>{this.toastr.error("Something went wrong"),console.log(t),this.isAdding=!1})):this.toastr.error("Empty trader name")}static \u0275fac=function(n){return new(n||i)(e.rXU(T.f),e.rXU(C))};static \u0275cmp=e.VBU({type:i,selectors:[["app-add-account"]],outputs:{traderAdded:"traderAdded"},decls:21,vars:3,consts:[["addAcountForm","ngForm"],[1,"row","h-100","align-items-center"],[1,"col-sm-1","col-md-2","col-lg-3"],[1,"col-sm-10","col-md-8","col-lg-6"],[1,"p-4","rounded","shadow-lg","bg-light",3,"ngSubmit"],[1,"form-group","text-center","my-3"],[1,"form-group","row","my-5"],[1,"col-md","input-group"],[1,"input-group-prepend"],["for","email",1,"input-group-text","col-form-label"],["required","","type","text","id","email","name","email","placeholder","My Name",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-row","justify-content-center","my-3"],[1,"form-group"],["type","submit",1,"btn","btn-info",3,"disabled"],[1,"p-3"],["class","form-row mx-0 mt-5",4,"ngIf"],[1,"col-sm-1","col-md-2","col-lg-6"],[1,"form-row","mx-0","mt-5"],[1,"col-md","text-center","text-info"]],template:function(n,r){if(1&n){const o=e.RV6();e.j41(0,"div",1),e.nrm(1,"div",2),e.j41(2,"div",3)(3,"form",4,0),e.bIt("ngSubmit",function(){return e.eBV(o),e.Njj(r.addEmail())}),e.j41(5,"div",5)(6,"h1"),e.EFF(7,"Add account"),e.k0s()(),e.j41(8,"div",6)(9,"div",7)(10,"div",8)(11,"label",9),e.EFF(12,"Username"),e.k0s()(),e.j41(13,"input",10),e.mxI("ngModelChange",function(l){return e.eBV(o),e.DH7(r.account.email,l)||(r.account.email=l),e.Njj(l)}),e.k0s()()(),e.j41(14,"div",11)(15,"div",12)(16,"button",13)(17,"span",14),e.EFF(18,"Add"),e.k0s()()()(),e.DNE(19,yt,4,0,"div",15),e.k0s()(),e.nrm(20,"div",16),e.k0s()}if(2&n){const o=e.sdS(4);e.R7$(13),e.R50("ngModel",r.account.email),e.R7$(3),e.Y8G("disabled",!o.form.valid),e.R7$(3),e.Y8G("ngIf",r.isAdding)}},dependencies:[f.bT,d.qT,d.me,d.BC,d.cb,d.YS,d.vS,d.cV]})}return i})();var Tt=c(5383);let kt=(()=>{class i{faArrowUp=Tt.INu;constructor(){}ngOnInit(){}goToProviderSite(){window.open("https://metamask.io/","_blank")}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-connection"]],decls:9,vars:1,consts:[[1,"text-center"],["transform","rotate-45",1,"mx-4",2,"color","#e7933c",3,"icon"],[1,"btn","btn-lg","btn-link",3,"click"]],template:function(n,r){1&n&&(e.j41(0,"h1",0),e.EFF(1," Connect to the MetaMask wallet "),e.nrm(2,"fa-icon",1),e.k0s(),e.j41(3,"h2",0),e.EFF(4,"or"),e.k0s(),e.j41(5,"h2",0),e.EFF(6," Install MetaMask wallet via "),e.j41(7,"a",2),e.bIt("click",function(){return r.goToProviderSite()}),e.EFF(8,"link"),e.k0s()()),2&n&&(e.R7$(2),e.Y8G("icon",r.faArrowUp))},dependencies:[O.aY]})}return i})();function Ft(i,s){1&i&&e.eu8(0)}function It(i,s){1&i&&(e.j41(0,"div",10),e.nrm(1,"app-connection"),e.k0s())}function Ct(i,s){1&i&&e.eu8(0)}function Bt(i,s){if(1&i&&e.DNE(0,Ct,1,0,"ng-container",9),2&i){const t=e.XpG(),n=e.sdS(7),r=e.sdS(9);e.Y8G("ngIf",!t.address)("ngIfThen",n)("ngIfElse",r)}}function xt(i,s){1&i&&(e.j41(0,"div",10)(1,"h2",11),e.EFF(2,"Error is occured while connecting to MetaMask"),e.k0s()())}function wt(i,s){1&i&&e.eu8(0)}function jt(i,s){if(1&i&&e.DNE(0,wt,1,0,"ng-container",9),2&i){const t=e.XpG(),n=e.sdS(11),r=e.sdS(13);e.Y8G("ngIf",void 0===t.email)("ngIfThen",n)("ngIfElse",r)}}function Et(i,s){1&i&&e.nrm(0,"ngx-spinner",12),2&i&&e.Y8G("bdColor","#6c757d")("color","#000000")}function At(i,s){1&i&&e.eu8(0)}function Dt(i,s){if(1&i&&e.DNE(0,At,1,0,"ng-container",9),2&i){const t=e.XpG(),n=e.sdS(15),r=e.sdS(17);e.Y8G("ngIf",t.email)("ngIfThen",r)("ngIfElse",n)}}function Rt(i,s){if(1&i){const t=e.RV6();e.j41(0,"div",13)(1,"app-add-account",14),e.bIt("traderAdded",function(r){e.eBV(t);const o=e.XpG();return e.Njj(o.onTraderAdded(r))}),e.k0s()()}}function Nt(i,s){1&i&&(e.j41(0,"div",13),e.nrm(1,"router-outlet"),e.k0s())}const Mt=[{path:"",component:(()=>{class i{contract;location;menuService;spinner;toastr;walletService;address=void 0;email=void 0;constructor(t,n,r,o,a,l){this.contract=t,this.location=n,this.menuService=r,this.spinner=o,this.toastr=a,this.walletService=l}ngOnInit(){this.initConnection(),this.initSpinner(),this.initMenu()}initConnection(){this.walletService.address$.pipe((0,vt.p)(t=>!!t),(0,y.M)(t=>{this.address=t}),(0,p.Z)(t=>(0,x.H)(this.contract.getEmail(t)))).subscribe(t=>{this.email=t,this.spinner.hide(),t&&this.initMenu(),this.toastr.success(this.address.slice(0,4)+"....."+this.address.slice(-4),"Connected to wallet:")})}initMenu(){let t=this.location.normalize(this.location.path()).split("/");this.menuService.changeState(t[1],t[2])}initSpinner(){this.spinner.show()}onTraderAdded(t){this.email=t,this.initMenu()}static \u0275fac=function(n){return new(n||i)(e.rXU("SmartContractInterface"),e.rXU(f.aZ),e.rXU(St.$),e.rXU(D.ex),e.rXU(T.f),e.rXU(te.F))};static \u0275cmp=e.VBU({type:i,selectors:[["app-prover"]],decls:18,vars:3,consts:[["notConnectedTmpl",""],["connectedTmpl",""],["errorConnectedTmpl",""],["successConnectedTemplate",""],["loadingTmpl",""],["loadedTmpl",""],["newAccountTmpl",""],["accountTmpl",""],[1,"row","h-100","w-100","m-0"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"col","m-3","p-3"],[1,"text-center"],["type","ball-scale-multiple",3,"bdColor","color"],[1,"col"],[3,"traderAdded"]],template:function(n,r){if(1&n&&(e.j41(0,"div",8),e.DNE(1,Ft,1,0,"ng-container",9),e.k0s(),e.DNE(2,It,2,0,"ng-template",null,0,e.C5r)(4,Bt,1,3,"ng-template",null,1,e.C5r)(6,xt,3,0,"ng-template",null,2,e.C5r)(8,jt,1,3,"ng-template",null,3,e.C5r)(10,Et,1,2,"ng-template",null,4,e.C5r)(12,Dt,1,3,"ng-template",null,5,e.C5r)(14,Rt,2,0,"ng-template",null,6,e.C5r)(16,Nt,2,0,"ng-template",null,7,e.C5r)),2&n){const o=e.sdS(3),a=e.sdS(5);e.R7$(),e.Y8G("ngIf",void 0===r.address)("ngIfThen",o)("ngIfElse",a)}},dependencies:[f.bT,R.n3,D.et,_t,kt]})}return i})(),children:[{path:"signals",component:ht},{path:"proof",component:Oe},{path:"followers",component:ie},{path:"**",redirectTo:"signals"}]}];let Pt=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=e.$C({type:i});static \u0275inj=e.G2t({imports:[R.iI.forChild(Mt),R.iI]})}return i})();var Gt=c(541),$t=c(9327),Vt=c(2634);let Ot=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=e.$C({type:i});static \u0275inj=e.G2t({imports:[f.MD,O.dX,d.YN,Pt,Gt.G.withProviders(Vt.N,$t.r),D.PO]})}return i})()}}]);